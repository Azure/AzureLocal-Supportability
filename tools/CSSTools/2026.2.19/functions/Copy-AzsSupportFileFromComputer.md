# Copy-AzsSupportFileFromComputer

## SYNOPSIS
Copies an item from one location to another using FromSession

## SYNTAX

```
Copy-AzsSupportFileFromComputer [-Path] <String[]> [-ComputerName] <String[]> [[-Destination] <FileInfo>]
 [[-Credential] <PSCredential>] [-Recurse] [-Force] [-ProgressAction <ActionPreference>] [<CommonParameters>]
```

## DESCRIPTION
This cmdlet is used to copy files from remote computer to local machine.
It will attempt to use SMB protocol for copying, if it fails, it will fallback to use WinRM protocol.

## EXAMPLES

### EXAMPLE 1
```
Copy-AzsSupportFileFromComputer -ComputerName "contoso-n01" -Path "C:\Logs\health.log" -Destination "C:\Temp\Collected"
```
This command copies the health.log file from contoso-n01 computer to C:\Temp\Collected folder on local machine.
If the copy is successful, it will return a FileInfo object representing the copied file in destination path.

## PARAMETERS

### -Path
Specifies, as a string array, the path to the items to copy.
Wildcard characters are permitted.

```yaml
Type: String[]
Parameter Sets: (All)
Aliases:

Required: True
Position: 1
Default value: None
Accept pipeline input: True (ByValue)
Accept wildcard characters: False
```

### -ComputerName
Type the NetBIOS name, an IP address, or a fully qualified domain name of one or more remote computers.

```yaml
Type: String[]
Parameter Sets: (All)
Aliases:

Required: True
Position: 2
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -Destination
Specifies the path to the new location.
The default is the current directory.
To rename the item being copied, specify a new name in the value of the Destination parameter.

```yaml
Type: FileInfo
Parameter Sets: (All)
Aliases:

Required: False
Position: 3
Default value: (Get-WorkingDirectory)
Accept pipeline input: False
Accept wildcard characters: False
```

### -Credential
Specifies a user account that has permission to perform this action.
The default is the current user.
Type a user name, such as User01 or Domain01\User01, or enter a PSCredential object generated by the Get-Credential cmdlet.
If you type a user name, you're prompted to enter the password.

```yaml
Type: PSCredential
Parameter Sets: (All)
Aliases:

Required: False
Position: 4
Default value: [System.Management.Automation.PSCredential]::Empty
Accept pipeline input: False
Accept wildcard characters: False
```

### -Recurse
Indicates that this cmdlet does a recursive copy.

```yaml
Type: SwitchParameter
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: False
Accept pipeline input: False
Accept wildcard characters: False
```

### -Force
Indicates that this cmdlet copies items that can't otherwise be changed, such as copying over a read-only file or alias.

```yaml
Type: SwitchParameter
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: False
Accept pipeline input: False
Accept wildcard characters: False
```

### -ProgressAction

```yaml
Type: ActionPreference
Parameter Sets: (All)
Aliases: proga

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### CommonParameters
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see [about_CommonParameters](http://go.microsoft.com/fwlink/?LinkID=113216).

## OUTPUTS

### System.IO.FileInfo
### Returns one or more FileInfo objects representing copied files in the destination path.Returns a FileInfo object representing the copied file.
### PS> Copy-AzsSupportFileFromComputer -ComputerName "contoso-n01" -Path "C:\Logs\health.log" -Destination "C:\Temp\Collected"
### Directory: C:\Temp\Collected
### Mode   LastWriteTime          Length Name
### ----   -------------          ------ ----
### -a---  02/18/2026 10:12 PM      4096 health.log
